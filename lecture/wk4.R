# R Programming Language
# Week 4 
# Section 1: str()



## str() and sunmmary()

str(lm)
str(ls)
x<-rnorm(100,2,4)
summary(x)
# Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
# -10.020  -1.330   1.581   1.636   4.391  12.470 
 str(x)
# num [1:100] -2.27 -6.03 1.16 5.41 8.21 ...
 f<-gl(40,10)
 str(f)
# Factor w/ 40 levels "1","2","3","4",..: 1 1 1 1 1 1 1 1 1 1 ...
 summary(f)
# 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 
# 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 
# 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 
# 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 

## use dataset
 library(datasets)
 head(airquality)
# Ozone Solar.R Wind Temp Month Day
# 1    41     190  7.4   67     5   1
# 2    36     118  8.0   72     5   2
# 3    12     149 12.6   74     5   3
# 4    18     313 11.5   62     5   4
# 5    NA      NA 14.3   56     5   5
# 6    28      NA 14.9   66     5   6
str(airquality)
# 'data.frame':        153 obs. of  6 variables:
#         $ Ozone  : int  41 36 12 18 NA 28 23 19 8 NA ...
# $ Solar.R: int  190 118 149 313 NA NA 299 99 19 194 ...
# $ Wind   : num  7.4 8 12.6 11.5 14.3 14.9 8.6 13.8 20.1 8.6 ...
# $ Temp   : int  67 72 74 62 56 66 65 59 61 69 ...
# $ Month  : int  5 5 5 5 5 5 5 5 5 5 ...
# $ Day    : int  1 2 3 4 5 6 7 8 9 10 ...
 m<-matrix(rnorm(100),10,10)
 str(m)
# num [1:10, 1:10] -0.532 2.484 1.141 -0.798 0.688 ...
m
# [,1]       [,2]        [,3]       [,4]       [,5]
# [1,] -0.5321751 -0.8279621  1.07510183 -3.1756329 -1.5231776
# [2,]  2.4837557  0.6463498  0.09786961  1.0269366 -0.2718866
# [3,]  1.1408418 -0.1054954 -1.54814923  2.3628522 -0.4754823
# [4,] -0.7976822 -0.3438242  1.23945697  2.0735124  0.2665622
# [5,]  0.6876411 -0.2704780  0.91431055 -1.2093307  0.6595575
# [6,] -0.4507941  0.2430163 -2.49636447  0.6769764  0.2589897
# [7,] -0.1498515  0.0583491  0.02922539 -0.9187276 -0.6312157
# [8,]  1.5860459  0.3964761 -0.99298796 -1.4159381 -0.4778424
# [9,] -1.1460309  0.5392355  0.84412705 -0.2247819  1.4387849
# [10,]  0.2290895 -0.2828319 -0.36159337  0.2108415 -0.6317400
# [,6]         [,7]        [,8]        [,9]
# [1,]  0.6288931  0.726443151 -1.43374716  0.39871631
# [2,]  0.9216644  1.138576965 -1.33464325 -0.70553746
# [3,]  0.2348776 -2.035115484 -1.29140133 -0.06704921
# [4,] -0.9868711 -0.463814994  0.27898124 -0.68146233
# [5,] -2.1021614 -0.652226013  0.01002442 -0.10608296
# [6,] -1.2625015 -1.883339685  2.50025315 -0.28371202
# [7,]  0.1416265 -0.356304984  0.49731968  0.43119305
# [8,]  2.0020464  0.120229078  0.24219879 -0.87652814
# [9,]  0.6709931 -0.910121232 -0.62932244  0.09151613
# [10,] -0.1635584  0.008789285 -0.22381682 -0.12945105
# [,10]
# [1,]  0.41771855
# [2,] -1.92655411
# [3,] -0.70367039
# [4,] -0.90483896
# [5,] -0.15899377
# [6,] -0.01621682
# [7,]  0.02713609
# [8,] -0.61986495
# [9,] -1.71788780
# [10,] -0.55746912
str(m)
# num [1:10, 1:10] -0.532 2.484 1.141 -0.798 0.688 ...
m[,1]
# [1] -0.5321751  2.4837557  1.1408418 -0.7976822  0.6876411
# [6] -0.4507941 -0.1498515  1.5860459 -1.1460309  0.2290895
s<-split(airquality,airquality$Month)
str(s)
# List of 5
# $ 5:'data.frame':	31 obs. of  6 variables:
#         ..$ Ozone  : int [1:31] 41 36 12 18 NA 28 23 19 8 NA ...
# ..$ Solar.R: int [1:31] 190 118 149 313 NA NA 299 99 19 194 ...
# ..$ Wind   : num [1:31] 7.4 8 12.6 11.5 14.3 14.9 8.6 13.8 20.1 8.6 ...
# ..$ Temp   : int [1:31] 67 72 74 62 56 66 65 59 61 69 ...
# ..$ Month  : int [1:31] 5 5 5 5 5 5 5 5 5 5 ...
# ..$ Day    : int [1:31] 1 2 3 4 5 6 7 8 9 10 ...
# $ 6:'data.frame':	30 obs. of  6 variables:
#         ..$ Ozone  : int [1:30] NA NA NA NA NA NA 29 NA 71 39 ...
# ..$ Solar.R: int [1:30] 286 287 242 186 220 264 127 273 291 323 ...
# ..$ Wind   : num [1:30] 8.6 9.7 16.1 9.2 8.6 14.3 9.7 6.9 13.8 11.5 ...
# ..$ Temp   : int [1:30] 78 74 67 84 85 79 82 87 90 87 ...
# ..$ Month  : int [1:30] 6 6 6 6 6 6 6 6 6 6 ...
# ..$ Day    : int [1:30] 1 2 3 4 5 6 7 8 9 10 ...
# $ 7:'data.frame':	31 obs. of  6 variables:
#         ..$ Ozone  : int [1:31] 135 49 32 NA 64 40 77 97 97 85 ...
# ..$ Solar.R: int [1:31] 269 248 236 101 175 314 276 267 272 175 ...
# ..$ Wind   : num [1:31] 4.1 9.2 9.2 10.9 4.6 10.9 5.1 6.3 5.7 7.4 ...
# ..$ Temp   : int [1:31] 84 85 81 84 83 83 88 92 92 89 ...
# ..$ Month  : int [1:31] 7 7 7 7 7 7 7 7 7 7 ...
# ..$ Day    : int [1:31] 1 2 3 4 5 6 7 8 9 10 ...

# Simulation

## Generating Random Numbers

x<-rnorm(10,0,10) # mean, std
summary(x)
# str(rnorm)
dnorm(3, 0, 50)
# str(dnorm)
pnorm()
# str(rpois)
rpois(3,1)

## Set the seed
set.seed(1)
rnorm(5)

## Poisson data
rpois(10,1)
rpois(10,2)
rpois(10,20)

## Cum distribution
ppois(2,2) # Pr(x<=2)
ppois(4,2) # Pr(x<=4)
ppois(6,2) # Pr(x<=6)

## Generate Random Number From a Linear Model
set.seed(20)
x<-rnorm(100)
e<-rnorm(100,0,2)
y<-0.5+2*x+e
summary(y)
plot(x,y)

## x is a binary

set.seed(10)
x<-rbinom(100,1,0.5)
e<-rnorm(100,0,2)
y<-0.5+2*x+e
summary(y)
plot(x,y)

## generate from generalized linear model
## y <- possion

set.seed(1)
x <- rnorm(100)
log.mu <- 0.5 + 0.3 * x
y <- rpois(100, exp(log.mu))
summary(y)
plot(x, y)

## sample()
set.seed(1)
sample(1:10, 4)
sample(letters,5)
sample(1:10) #permutation
sample(1:10)
sample(1:10,replace=TRUE) # get repeat num


## Section 3: R profiler

## Elapsed time > user time
system.time(readLines("http://www.jhsph.edu"))
# user  system elapsed 
# 0.004   0.002   0.431 

## Elapsed time < user time
hilbert <- function(n) { 
        i <- 1:n
        1 / outer(i - 1, i, "+")
}
x <- hilbert(1000)
system.time(svd(x))


# same
system.time({
        n <- 1000
        r <- numeric(n)
        for (i in 1:n) {
                x <- rnorm(n)
                r[i] <- mean(x)
        }
})


# Rprof()

## lm(y ~ x)

sample.interval=10000
